<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>spectrum_fundamentals.annotation package &mdash; spectrum_fundamentals 0.5.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/custom_cookietemple.css?v=057798b9" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=c3dca1ed"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="spectrum_fundamentals.metrics package" href="spectrum_fundamentals.metrics.html" />
    <link rel="prev" title="spectrum_fundamentals package" href="spectrum_fundamentals.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            spectrum_fundamentals
          </a>
              <div class="version">
                0.5.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">spectrum_fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_of_conduct.html">Contributor Covenant Code of Conduct</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">spectrum_fundamentals</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="spectrum_fundamentals.html">spectrum_fundamentals package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="spectrum_fundamentals.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">spectrum_fundamentals.annotation package</a></li>
<li class="toctree-l4"><a class="reference internal" href="spectrum_fundamentals.metrics.html">spectrum_fundamentals.metrics package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_fundamentals.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_fundamentals.html#module-spectrum_fundamentals.charge">spectrum_fundamentals.charge module</a></li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_fundamentals.html#module-spectrum_fundamentals.constants">spectrum_fundamentals.constants module</a></li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_fundamentals.html#module-spectrum_fundamentals.fragments">spectrum_fundamentals.fragments module</a></li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_fundamentals.html#module-spectrum_fundamentals.mod_string">spectrum_fundamentals.mod_string module</a></li>
<li class="toctree-l3"><a class="reference internal" href="spectrum_fundamentals.html#module-spectrum_fundamentals">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">spectrum_fundamentals.annotation package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-spectrum_fundamentals.annotation.annotation">spectrum_fundamentals.annotation.annotation module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spectrum_fundamentals.annotation.annotation.annotate_spectra"><code class="docutils literal notranslate"><span class="pre">annotate_spectra()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectrum_fundamentals.annotation.annotation.generate_annotation_matrix"><code class="docutils literal notranslate"><span class="pre">generate_annotation_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectrum_fundamentals.annotation.annotation.generate_annotation_matrix_xl"><code class="docutils literal notranslate"><span class="pre">generate_annotation_matrix_xl()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectrum_fundamentals.annotation.annotation.handle_multiple_matches"><code class="docutils literal notranslate"><span class="pre">handle_multiple_matches()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectrum_fundamentals.annotation.annotation.match_peaks"><code class="docutils literal notranslate"><span class="pre">match_peaks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectrum_fundamentals.annotation.annotation.parallel_annotate"><code class="docutils literal notranslate"><span class="pre">parallel_annotate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#spectrum_fundamentals.annotation.annotation.peak_pos_xl_cms2"><code class="docutils literal notranslate"><span class="pre">peak_pos_xl_cms2()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-spectrum_fundamentals.annotation">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spectrum_fundamentals.metrics.html">spectrum_fundamentals.metrics package</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">spectrum_fundamentals</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">spectrum_fundamentals</a></li>
          <li class="breadcrumb-item"><a href="spectrum_fundamentals.html">spectrum_fundamentals package</a></li>
      <li class="breadcrumb-item active">spectrum_fundamentals.annotation package</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/wilhelm-lab/spectrum_fundamentals/blob/main/spectrum_fundamentals/spectrum_fundamentals.annotation.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="spectrum-fundamentals-annotation-package">
<h1>spectrum_fundamentals.annotation package<a class="headerlink" href="#spectrum-fundamentals-annotation-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-spectrum_fundamentals.annotation.annotation">
<span id="spectrum-fundamentals-annotation-annotation-module"></span><h2>spectrum_fundamentals.annotation.annotation module<a class="headerlink" href="#module-spectrum_fundamentals.annotation.annotation" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spectrum_fundamentals.annotation.annotation.annotate_spectra">
<span class="sig-prename descclassname"><span class="pre">spectrum_fundamentals.annotation.annotation.</span></span><span class="sig-name descname"><span class="pre">annotate_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">un_annot_spectra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_mass_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wilhelm-lab/spectrum_fundamentals/blob/documentation/spectrum_fundamentals/annotation/annotation.py#L121-L165"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spectrum_fundamentals.annotation.annotation.annotate_spectra" title="Permalink to this definition"></a></dt>
<dd><p>Annotate a set of spectra.</p>
<p>This function takes a DataFrame of raw peaks and metadata, and for each spectrum, it calls the <cite>parallel_annotate</cite> function
to annotate the spectrum and extract the necessary information. If there are any redundant peaks found in the annotation
process, the function removes them and logs the information. Finally, it returns a Pandas DataFrame containing the annotated
spectra with meta data.</p>
<p>The returned DataFrame has the following columns:
- INTENSITIES: a NumPy array containing the intensity values of each peak in the annotated spectrum
- MZ: a NumPy array containing the m/z values of each peak in the annotated spectrum
- CALCULATED_MASS: a float representing the calculated mass of the spectrum
- removed_peaks: a NumPy array containing the indices of any peaks that were removed during the annotation process</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>un_annot_spectra</strong> (<em>DataFrame</em>) – a Pandas DataFrame containing the raw peaks and metadata to be annotated</p></li>
<li><p><strong>mass_tolerance</strong> (<em>float</em><em> | </em><em>None</em>) – mass tolerance to calculate min and max mass</p></li>
<li><p><strong>unit_mass_tolerance</strong> (<em>str</em><em> | </em><em>None</em>) – unit for the mass tolerance (da or ppm)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a Pandas DataFrame containing the annotated spectra with meta data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>DataFrame</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectrum_fundamentals.annotation.annotation.generate_annotation_matrix">
<span class="sig-prename descclassname"><span class="pre">spectrum_fundamentals.annotation.annotation.</span></span><span class="sig-name descname"><span class="pre">generate_annotation_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matched_peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unmod_seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wilhelm-lab/spectrum_fundamentals/blob/documentation/spectrum_fundamentals/annotation/annotation.py#L271-L323"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spectrum_fundamentals.annotation.annotation.generate_annotation_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Generate the annotation matrix in the prosit format from matched peaks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matched_peaks</strong> (<em>DataFrame</em>) – matched peaks needed to be converted</p></li>
<li><p><strong>unmod_seq</strong> (<em>str</em>) – Un modified peptide sequence</p></li>
<li><p><strong>charge</strong> (<em>int</em>) – Precursor charge</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy array of intensities and numpy array of masses</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<em>ndarray</em>, <em>ndarray</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectrum_fundamentals.annotation.annotation.generate_annotation_matrix_xl">
<span class="sig-prename descclassname"><span class="pre">spectrum_fundamentals.annotation.annotation.</span></span><span class="sig-name descname"><span class="pre">generate_annotation_matrix_xl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matched_peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unmod_seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crosslinker_position</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wilhelm-lab/spectrum_fundamentals/blob/documentation/spectrum_fundamentals/annotation/annotation.py#L224-L268"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spectrum_fundamentals.annotation.annotation.generate_annotation_matrix_xl" title="Permalink to this definition"></a></dt>
<dd><p>Generate the annotation matrix in the xl_prosit format from matched peaks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matched_peaks</strong> (<em>DataFrame</em>) – matched peaks needed to be converted</p></li>
<li><p><strong>unmod_seq</strong> (<em>str</em>) – unmodified peptide sequence</p></li>
<li><p><strong>crosslinker_position</strong> (<em>int</em>) – position of crosslinker</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy array of intensities and numpy array of masses</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<em>ndarray</em>, <em>ndarray</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectrum_fundamentals.annotation.annotation.handle_multiple_matches">
<span class="sig-prename descclassname"><span class="pre">spectrum_fundamentals.annotation.annotation.</span></span><span class="sig-name descname"><span class="pre">handle_multiple_matches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matched_peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mass_diff'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wilhelm-lab/spectrum_fundamentals/blob/documentation/spectrum_fundamentals/annotation/annotation.py#L83-L118"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spectrum_fundamentals.annotation.annotation.handle_multiple_matches" title="Permalink to this definition"></a></dt>
<dd><p>Resolve cases where multiple peaks have been matched to the same fragment ion.</p>
<p>This function takes a list of dictionaries representing matched peaks and resolves cases where multiple peaks have
been matched to the same fragment ion. The function sorts the peaks based on the provided <cite>sort_by</cite> parameter and
removes duplicate matches based on ion type, ion number, and charge state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matched_peaks</strong> (<em>List</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em> | </em><em>int</em><em> | </em><em>float</em><em>]</em><em>]</em>) – A list of dictionaries, each representing a matched peak. Each dictionary must contain the
following keys: ‘ion_type’, ‘no’, ‘charge’, ‘exp_mass’, ‘theoretical_mass’, and ‘intensity’.</p></li>
<li><p><strong>sort_by</strong> (<em>str</em>) – A string indicating the criterion to use when sorting matched peaks. Valid options are:
‘mass_diff’ (sort by absolute difference between experimental and theoretical mass, ascending order),
‘intensity’ (sort by intensity, descending order), and ‘exp_mass’ (sort by experimental mass,
descending order).</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If an unsupported value is passed to <cite>sort_by</cite>.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple containing a DataFrame of matched peaks (with duplicates removed) and an integer indicating the
number of duplicate matches that were removed.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tuple</em>[<em>DataFrame</em>, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectrum_fundamentals.annotation.annotation.match_peaks">
<span class="sig-prename descclassname"><span class="pre">spectrum_fundamentals.annotation.annotation.</span></span><span class="sig-name descname"><span class="pre">match_peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fragments_meta_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peaks_intensity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peaks_masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmt_n_term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unmod_sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wilhelm-lab/spectrum_fundamentals/blob/documentation/spectrum_fundamentals/annotation/annotation.py#L13-L80"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spectrum_fundamentals.annotation.annotation.match_peaks" title="Permalink to this definition"></a></dt>
<dd><p>Matching experimental peaks with theoretical fragment ions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fragments_meta_data</strong> (<em>List</em><em>[</em><em>dict</em><em>]</em>) – Fragments ions meta data eg. ion type, number, theo_mass…</p></li>
<li><p><strong>peaks_intensity</strong> (<em>ndarray</em>) – Experimental peaks intensities</p></li>
<li><p><strong>peaks_masses</strong> (<em>ndarray</em>) – Experimental peaks masses</p></li>
<li><p><strong>tmt_n_term</strong> (<em>int</em>) – Flag to check if there is tmt modification on n_terminus 1: no_tmt, 2:tmt</p></li>
<li><p><strong>unmod_sequence</strong> (<em>str</em>) – Unmodified peptide sequence</p></li>
<li><p><strong>charge</strong> (<em>int</em>) – Precursor charge</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of matched/annotated peaks</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<em>Dict</em>[str, str | int | float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectrum_fundamentals.annotation.annotation.parallel_annotate">
<span class="sig-prename descclassname"><span class="pre">spectrum_fundamentals.annotation.annotation.</span></span><span class="sig-name descname"><span class="pre">parallel_annotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectrum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_columns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_mass_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wilhelm-lab/spectrum_fundamentals/blob/documentation/spectrum_fundamentals/annotation/annotation.py#L326-L364"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spectrum_fundamentals.annotation.annotation.parallel_annotate" title="Permalink to this definition"></a></dt>
<dd><p>Perform parallel annotation of a spectrum.</p>
<p>This function takes a spectrum and its index columns and performs parallel annotation of the spectrum.
It starts by initializing the peaks and extracting necessary data from the spectrum.
It then matches the peaks to the spectrum and generates an annotation matrix based on the matched peaks.
If there are multiple matches found, it removes the redundant matches.
Finally, it returns annotated spectrum with meta data including intensity values, masses, calculated masses,
and any peaks that were removed. The function is designed to run in different threads to speed up the annotation pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spectrum</strong> (<em>ndarray</em>) – a np.ndarray that contains the spectrum to be annotated</p></li>
<li><p><strong>index_columns</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em>) – a dictionary that contains the index columns of the spectrum</p></li>
<li><p><strong>mass_tolerance</strong> (<em>float</em><em> | </em><em>None</em>) – mass tolerance to calculate min and max mass</p></li>
<li><p><strong>unit_mass_tolerance</strong> (<em>str</em><em> | </em><em>None</em>) – unit for the mass tolerance (da or ppm)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple containing intensity values (np.ndarray), masses (np.ndarray), calculated mass (float),
and any removed peaks (List[str])</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<em>ndarray</em>, <em>ndarray</em>, float, int] | <em>Tuple</em>[<em>ndarray</em>, <em>ndarray</em>, <em>ndarray</em>, <em>ndarray</em>, float, float, int, int] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectrum_fundamentals.annotation.annotation.peak_pos_xl_cms2">
<span class="sig-prename descclassname"><span class="pre">spectrum_fundamentals.annotation.annotation.</span></span><span class="sig-name descname"><span class="pre">peak_pos_xl_cms2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unmod_seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crosslinker_position</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/wilhelm-lab/spectrum_fundamentals/blob/documentation/spectrum_fundamentals/annotation/annotation.py#L168-L221"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spectrum_fundamentals.annotation.annotation.peak_pos_xl_cms2" title="Permalink to this definition"></a></dt>
<dd><p>Determines the positions of all potential normal and xl fragments within the vector generated by generate_annotation_matrix.</p>
<p>This function is used only for cleavable crosslinked peptides.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unmod_seq</strong> (<em>str</em>) – Unmodified peptide sequence</p></li>
<li><p><strong>crosslinker_position</strong> (<em>int</em>) – The position of the crosslinker</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if peptides exceed a length of 30</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>position of different fragments as list</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-spectrum_fundamentals.annotation">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-spectrum_fundamentals.annotation" title="Permalink to this heading"></a></h2>
<p>Initialize annotation.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="spectrum_fundamentals.html" class="btn btn-neutral float-left" title="spectrum_fundamentals package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="spectrum_fundamentals.metrics.html" class="btn btn-neutral float-right" title="spectrum_fundamentals.metrics package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Victor Giurcoiu.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>